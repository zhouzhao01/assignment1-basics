{
    "exp_name": "transformer_lm_40m_4090",
    "seed": 42,
    "device": "cuda",

    "tokenizer":{
        "vocab_size":10000,
        "path":"/mnt/aat/zzhao.zhou/cs336_2025/assignment1-basics/basic_blocks/tokenizer_tiny_story.json"
    },

    "model": {
        "vocab_size": 10000,
        "context_length": 256,
        "num_layers": 4,
        "d_model": 512,
        "num_heads": 16,
        "d_ff": 1344,
        
        "use_fast_attn": false,
        "rope_theta": null,

        "layer_norm": "pre",
        "posision_embedding": "NoPE",
        "activation_function": "SwiGLU"
    },

    "training": {
        "epoch": 1,
        "batch_size": 64
    },

    "optimizer": {
        "type": "custom_AdamW",
        "lr": 6e-7,
        "betas": [0.9, 0.95],
        "weight_decay": 0.1,
        "eps": 1e-8
    },

    "lr_scheduler": {
        "type": "custom_CosineAnnealingLR",
        "max_learning_rate": 6e-5,
        "min_learning_rate": 6e-7,
        "warmup_iters": 1000
    },

    "data": {
        "train_dataset": "data/TinyStoriesV2-GPT4-train_tinyTokenizer_10000.npy",
        "valid_dataset": "data/TinyStoriesV2-GPT4-valid_tinyTokenizer_10000.npy"
    },

    "checkpoint": {
        "save_dir": "runs",
        "save_every_n_steps": 1000,
        "keep_last_n": 3
    },

    "profiling": {
        "enabled": false,
        "log_every_n_steps": 10
    }
}
